<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>6 Spatial Clustering | rgeoda version 0.0.3</title>
  <meta name="description" content="This is a tutorial book to introduce the rgeoda v0.0.3 library. This book includes all the functions that are provided in version 0.0.3. Since rgeoda is under active development, this book will be updated frequently. Please watch this github repository to get any notifications." />
  <meta name="generator" content="bookdown 0.14 and GitBook 2.6.7" />

  <meta property="og:title" content="6 Spatial Clustering | rgeoda version 0.0.3" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This is a tutorial book to introduce the rgeoda v0.0.3 library. This book includes all the functions that are provided in version 0.0.3. Since rgeoda is under active development, this book will be updated frequently. Please watch this github repository to get any notifications." />
  <meta name="github-repo" content="rgeoda/book_intro" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="6 Spatial Clustering | rgeoda version 0.0.3" />
  
  <meta name="twitter:description" content="This is a tutorial book to introduce the rgeoda v0.0.3 library. This book includes all the functions that are provided in version 0.0.3. Since rgeoda is under active development, this book will be updated frequently. Please watch this github repository to get any notifications." />
  

<meta name="author" content="Xun Li" />


<meta name="date" content="2019-10-09" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="spatial-autocorrelation.html"/>
<link rel="next" href="esda-with-rgeoda-and-sp.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
<link rel="stylesheet" href="toc.css" type="text/css" />
<link rel="stylesheet" href="fontawesome.min.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">rgeoda v0.0.3</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a></li>
<li class="chapter" data-level="2" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>2</b> Installation</a><ul>
<li class="chapter" data-level="2.1" data-path="intro.html"><a href="intro.html#mac-and-linux"><i class="fa fa-check"></i><b>2.1</b> Mac and Linux</a></li>
<li class="chapter" data-level="2.2" data-path="intro.html"><a href="intro.html#windows"><i class="fa fa-check"></i><b>2.2</b> Windows</a></li>
<li class="chapter" data-level="2.3" data-path="intro.html"><a href="intro.html#load-rgeoda-library-in-r"><i class="fa fa-check"></i><b>2.3</b> Load rgeoda library in R</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="load-spatial-data.html"><a href="load-spatial-data.html"><i class="fa fa-check"></i><b>3</b> Load Spatial Data</a><ul>
<li class="chapter" data-level="3.1" data-path="load-spatial-data.html"><a href="load-spatial-data.html#attributes-of-geoda-object"><i class="fa fa-check"></i><b>3.1</b> Attributes of <code>geoda</code> object</a></li>
<li class="chapter" data-level="3.2" data-path="load-spatial-data.html"><a href="load-spatial-data.html#access-table-data"><i class="fa fa-check"></i><b>3.2</b> Access Table Data</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="spatial-weights.html"><a href="spatial-weights.html"><i class="fa fa-check"></i><b>4</b> Spatial Weights</a><ul>
<li class="chapter" data-level="4.1" data-path="spatial-weights.html"><a href="spatial-weights.html#queen-contiguity-weights"><i class="fa fa-check"></i><b>4.1</b> Queen Contiguity Weights</a></li>
<li class="chapter" data-level="4.2" data-path="spatial-weights.html"><a href="spatial-weights.html#attributes-of-weight-object"><i class="fa fa-check"></i><b>4.2</b> Attributes of <code>Weight</code> object</a></li>
<li class="chapter" data-level="4.3" data-path="spatial-weights.html"><a href="spatial-weights.html#rook-contiguity-weights"><i class="fa fa-check"></i><b>4.3</b> Rook Contiguity Weights</a></li>
<li class="chapter" data-level="4.4" data-path="spatial-weights.html"><a href="spatial-weights.html#distance-based-weights"><i class="fa fa-check"></i><b>4.4</b> Distance Based Weights</a></li>
<li class="chapter" data-level="4.5" data-path="spatial-weights.html"><a href="spatial-weights.html#k-nearest-neighbor-weights"><i class="fa fa-check"></i><b>4.5</b> K-Nearest Neighbor Weights</a></li>
<li class="chapter" data-level="4.6" data-path="spatial-weights.html"><a href="spatial-weights.html#kernel-weights"><i class="fa fa-check"></i><b>4.6</b> Kernel Weights</a><ul>
<li class="chapter" data-level="4.6.1" data-path="spatial-weights.html"><a href="spatial-weights.html#kernel-weights-with-fixed-bandwidth"><i class="fa fa-check"></i><b>4.6.1</b> Kernel Weights with fixed bandwidth</a></li>
<li class="chapter" data-level="4.6.2" data-path="spatial-weights.html"><a href="spatial-weights.html#kernel-weights-with-adaptive-bandwidth"><i class="fa fa-check"></i><b>4.6.2</b> Kernel Weights with adaptive bandwidth</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="spatial-autocorrelation.html"><a href="spatial-autocorrelation.html"><i class="fa fa-check"></i><b>5</b> Spatial Autocorrelation</a><ul>
<li class="chapter" data-level="5.1" data-path="spatial-autocorrelation.html"><a href="spatial-autocorrelation.html#local-moran"><i class="fa fa-check"></i><b>5.1</b> Local Moran</a></li>
<li class="chapter" data-level="5.2" data-path="spatial-autocorrelation.html"><a href="spatial-autocorrelation.html#lisa-object"><i class="fa fa-check"></i><b>5.2</b> LISA object</a></li>
<li class="chapter" data-level="5.3" data-path="spatial-autocorrelation.html"><a href="spatial-autocorrelation.html#local-geary"><i class="fa fa-check"></i><b>5.3</b> Local Geary</a></li>
<li class="chapter" data-level="5.4" data-path="spatial-autocorrelation.html"><a href="spatial-autocorrelation.html#local-getis-ord-statistics"><i class="fa fa-check"></i><b>5.4</b> Local Getis-Ord Statistics</a></li>
<li class="chapter" data-level="5.5" data-path="spatial-autocorrelation.html"><a href="spatial-autocorrelation.html#local-join-count"><i class="fa fa-check"></i><b>5.5</b> Local Join Count</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="spatial-clustering.html"><a href="spatial-clustering.html"><i class="fa fa-check"></i><b>6</b> Spatial Clustering</a><ul>
<li class="chapter" data-level="6.1" data-path="spatial-clustering.html"><a href="spatial-clustering.html#skater"><i class="fa fa-check"></i><b>6.1</b> SKATER</a></li>
<li class="chapter" data-level="6.2" data-path="spatial-clustering.html"><a href="spatial-clustering.html#redcap"><i class="fa fa-check"></i><b>6.2</b> REDCAP</a></li>
<li class="chapter" data-level="6.3" data-path="spatial-clustering.html"><a href="spatial-clustering.html#max-p"><i class="fa fa-check"></i><b>6.3</b> Max-p</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="esda-with-rgeoda-and-sp.html"><a href="esda-with-rgeoda-and-sp.html"><i class="fa fa-check"></i><b>7</b> ESDA with rgeoda and sp</a><ul>
<li class="chapter" data-level="7.1" data-path="esda-with-rgeoda-and-sp.html"><a href="esda-with-rgeoda-and-sp.html#start-from-sp-package"><i class="fa fa-check"></i><b>7.1</b> Start from sp package</a></li>
<li class="chapter" data-level="7.2" data-path="esda-with-rgeoda-and-sp.html"><a href="esda-with-rgeoda-and-sp.html#create-geoda-object-from-sp"><i class="fa fa-check"></i><b>7.2</b> Create geoda object from sp</a></li>
<li class="chapter" data-level="7.3" data-path="esda-with-rgeoda-and-sp.html"><a href="esda-with-rgeoda-and-sp.html#esda-with-rgeoda-and-sp-1"><i class="fa fa-check"></i><b>7.3</b> ESDA with rgeoda and sp</a><ul>
<li class="chapter" data-level="7.3.1" data-path="esda-with-rgeoda-and-sp.html"><a href="esda-with-rgeoda-and-sp.html#local-moran-map"><i class="fa fa-check"></i><b>7.3.1</b> Local Moran Map</a></li>
<li class="chapter" data-level="7.3.2" data-path="esda-with-rgeoda-and-sp.html"><a href="esda-with-rgeoda-and-sp.html#local-geary-map"><i class="fa fa-check"></i><b>7.3.2</b> Local Geary Map</a></li>
<li class="chapter" data-level="7.3.3" data-path="esda-with-rgeoda-and-sp.html"><a href="esda-with-rgeoda-and-sp.html#local-g-map"><i class="fa fa-check"></i><b>7.3.3</b> Local G Map</a></li>
<li class="chapter" data-level="7.3.4" data-path="esda-with-rgeoda-and-sp.html"><a href="esda-with-rgeoda-and-sp.html#skater-map"><i class="fa fa-check"></i><b>7.3.4</b> SKATER Map</a></li>
<li class="chapter" data-level="7.3.5" data-path="esda-with-rgeoda-and-sp.html"><a href="esda-with-rgeoda-and-sp.html#max-p-clustering-map"><i class="fa fa-check"></i><b>7.3.5</b> Max-p Clustering Map</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="esda-with-rgeoda-and-sf.html"><a href="esda-with-rgeoda-and-sf.html"><i class="fa fa-check"></i><b>8</b> ESDA with rgeoda and sf</a><ul>
<li class="chapter" data-level="8.1" data-path="esda-with-rgeoda-and-sf.html"><a href="esda-with-rgeoda-and-sf.html#start-from-sf-package"><i class="fa fa-check"></i><b>8.1</b> Start from sf package</a></li>
<li class="chapter" data-level="8.2" data-path="esda-with-rgeoda-and-sf.html"><a href="esda-with-rgeoda-and-sf.html#create-geoda-object-from-sf"><i class="fa fa-check"></i><b>8.2</b> Create geoda object from sf</a></li>
<li class="chapter" data-level="8.3" data-path="esda-with-rgeoda-and-sf.html"><a href="esda-with-rgeoda-and-sf.html#esda-with-rgeoda-and-sf-1"><i class="fa fa-check"></i><b>8.3</b> ESDA with rgeoda and sf</a><ul>
<li class="chapter" data-level="8.3.1" data-path="esda-with-rgeoda-and-sf.html"><a href="esda-with-rgeoda-and-sf.html#local-moran-map-1"><i class="fa fa-check"></i><b>8.3.1</b> Local Moran Map</a></li>
<li class="chapter" data-level="8.3.2" data-path="esda-with-rgeoda-and-sf.html"><a href="esda-with-rgeoda-and-sf.html#local-geary-map-1"><i class="fa fa-check"></i><b>8.3.2</b> Local Geary Map</a></li>
<li class="chapter" data-level="8.3.3" data-path="esda-with-rgeoda-and-sf.html"><a href="esda-with-rgeoda-and-sf.html#local-g-map-1"><i class="fa fa-check"></i><b>8.3.3</b> Local G Map</a></li>
<li class="chapter" data-level="8.3.4" data-path="esda-with-rgeoda-and-sf.html"><a href="esda-with-rgeoda-and-sf.html#skater-map-1"><i class="fa fa-check"></i><b>8.3.4</b> SKATER Map</a></li>
<li class="chapter" data-level="8.3.5" data-path="esda-with-rgeoda-and-sf.html"><a href="esda-with-rgeoda-and-sf.html#max-p-clustering-map-1"><i class="fa fa-check"></i><b>8.3.5</b> Max-p Clustering Map</a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">rgeoda version 0.0.3</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="spatial-clustering" class="section level1">
<h1><span class="header-section-number">6</span> Spatial Clustering</h1>
<p>Spatial clustering aims to group of a large number of geographic areas or points into a smaller number of regions based on similiarities in one or more variables. Spatially constrained clustering is needed when clusters are required to be spatially contiguous.</p>
<p>In rgeoda v0.0.3, there are three different approaches explicitly incorporate the contiguity constraint in the optimization process: SKATER, Redcap and Max-p. More more details, please read the lab note that Dr. Luc Anselin wrote: <a href="http://geodacenter.github.io/workbook/8_spatial_clusters/lab8.html" class="uri">http://geodacenter.github.io/workbook/8_spatial_clusters/lab8.html</a></p>
<p>For example, to apply spatial clustering on the Guerry dataset, we use the queen weights to define the spatial contiguity and select 6 variables for similarity measure: “Crm_prs”, “Crm_prp”, “Litercy”, “Donatns”, “Infants”, “Suicids”.</p>
<p>The following code is used to get a 2D data list for the selected variables:</p>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb86-1" data-line-number="1">data &lt;-<span class="st"> </span><span class="kw">list</span>(guerry<span class="op">$</span>table<span class="op">$</span>Crm_prs, guerry<span class="op">$</span>table<span class="op">$</span>Crm_prp, guerry<span class="op">$</span>table<span class="op">$</span>Litercy, guerry<span class="op">$</span>table<span class="op">$</span>Donatns, guerry<span class="op">$</span>table<span class="op">$</span>Infants, guerry<span class="op">$</span>table<span class="op">$</span>Suicids)</a></code></pre></div>
<div id="skater" class="section level2">
<h2><span class="header-section-number">6.1</span> SKATER</h2>
<p>The Spatial C(K)luster Analysis by Tree Edge Removal(SKATER) algorithm introduced by Assuncao et al. (2006) is based on the optimal pruning of a minimum spanning tree that reflects the contiguity structure among the observations. It provides an optimized algorithm to prune to tree into several clusters that their values of selected variables are as similar as possible.</p>
<p>The SKATER function in rgeoda:</p>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb87-1" data-line-number="1"><span class="kw">skater</span>(k, w, data, <span class="dt">distance_method=</span><span class="st">&#39;euclidean&#39;</span>, <span class="dt">bound_vals =</span> [],  <span class="dt">min_bound =</span> <span class="dv">0</span>, <span class="dt">random_seed=</span><span class="dv">123456789</span>)</a></code></pre></div>
<div class="rmdinfo">
<p>
The parameters <code>distance_method</code>, <code>bound_vals</code>, <code>min_bound</code> and <code>random_seed</code> are optional.
</p>
</div>
<div class="rmdtip">
<p>
See <a href="spatial-clustering.html#max-p">Max-p</a> for the usage of <code>bound_vals</code> and <code>min_bound</code>.
</p>
</div>
<p>For example, to create 4 spatially contiguous clusters using <code>skater()</code> with Guerry dataset, the queen weights and the values of the 6 selected variables:</p>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb88-1" data-line-number="1">guerry_clusters &lt;-<span class="st"> </span><span class="kw">skater</span>(<span class="dv">4</span>, queen_w, data)</a></code></pre></div>
<p>This <code>skater()</code> function returns a 2D list, which represents 4 clusters. Each cluster is composed by several contiguity areas, e.g. 15, 74, 16, 55, 60, 39, 68, 33, 17, 82, 81, 0, 2, 40, 20, 80</p>
<p>rgeoda also provides utility functions to compute some descriptive statistics of the clustering results, e.g. to compute the ratio of between to total sum of squares:</p>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb89-1" data-line-number="1">betweenss &lt;-<span class="st"> </span><span class="kw">between_sumofsquare</span>(guerry_clusters, data)</a>
<a class="sourceLine" id="cb89-2" data-line-number="2">totalss &lt;-<span class="st"> </span><span class="kw">total_sumofsquare</span>( data)</a>
<a class="sourceLine" id="cb89-3" data-line-number="3">ratio &lt;-<span class="st">  </span>betweenss <span class="op">/</span><span class="st"> </span>totalss</a>
<a class="sourceLine" id="cb89-4" data-line-number="4"><span class="kw">cat</span>(<span class="st">&quot;The ratio of between to total sum of square:&quot;</span>, ratio)</a></code></pre></div>
<pre><code>## The ratio of between to total sum of square: 0.3156447</code></pre>
</div>
<div id="redcap" class="section level2">
<h2><span class="header-section-number">6.2</span> REDCAP</h2>
<p>REDCAP (Regionalization with dynamically constrained agglomerative clustering and partitioning) is developed by D. Guo (2008). Like SKATER, REDCAP starts from building a spanning tree with 3 different ways (single-linkage, average-linkage, and the complete-linkage). The single-linkage way leads to build a minimum spanning tree. Then,REDCAP provides 2 different ways (first‐order and full-order constraining) to prune the tree to find clusters. The first-order approach with a minimum spanning tree is exactly the same with SKATER. In GeoDa and rgeoda, the following methods are provided:</p>
<ul>
<li>First-order and Single-linkage</li>
<li>Full-order and Complete-linkage</li>
<li>Full-order and Average-linkage</li>
<li>Full-order and Single-linkage</li>
</ul>
<p>For example, to find 4 clusters using the same dataset and weights as above using REDCAP with Full-order and Complete-linkage method:</p>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb91-1" data-line-number="1">redcap_clusters &lt;-<span class="st"> </span><span class="kw">redcap</span>(<span class="dv">4</span>, queen_w, data, <span class="st">&quot;fullorder-completelinkage&quot;</span>)</a>
<a class="sourceLine" id="cb91-2" data-line-number="2">redcap_clusters</a></code></pre></div>
<pre><code>## [[1]]
##  [1] 15 74 16 55 60 39 68 33 17 82 81  0  2 40 20 80
## 
## [[2]]
##  [1] 46 50 34 38 69 47 58 19 32 41 53 26
## 
## [[3]]
##  [1] 23 79  3 29 61 21 44 11 28 13 30 35 76 77 43  9 27 45 31 78  4 10 66
## [24] 37  5 14  7 63 62
## 
## [[4]]
##  [1] 49 52 72 84  8 57 56 59 42  1 25 51 48 54 64 75 18 83 73 36 24 71  6
## [24] 67 65 70 22 12</code></pre>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb93-1" data-line-number="1">betweenss &lt;-<span class="st"> </span><span class="kw">between_sumofsquare</span>(redcap_clusters, data)</a>
<a class="sourceLine" id="cb93-2" data-line-number="2">totalss &lt;-<span class="st"> </span><span class="kw">total_sumofsquare</span>( data)</a>
<a class="sourceLine" id="cb93-3" data-line-number="3">ratio &lt;-<span class="st"> </span>betweenss <span class="op">/</span><span class="st"> </span>totalss</a>
<a class="sourceLine" id="cb93-4" data-line-number="4"><span class="kw">cat</span>(<span class="st">&quot;The ratio of between to total sum of square:&quot;</span>, ratio)</a></code></pre></div>
<pre><code>## The ratio of between to total sum of square: 0.3156447</code></pre>
</div>
<div id="max-p" class="section level2">
<h2><span class="header-section-number">6.3</span> Max-p</h2>
<p>The so-called max-p regions model (outlined in Duque, Anselin, and Rey 2012) uses a different approach and considers the regionalization problem as an application of integer programming. In addition, the number of regions is determined endogenously.</p>
<p>The algorithm itself consists of a search process that starts with an initial feasible solution and iteratively improves upon it while maintaining contiguity among the elements of each cluster. Like Geoda, rgeoda provides three different heuristic algorithms to find an optimal solution for max-p:</p>
<ul>
<li>greedy</li>
<li>Tabu Search</li>
<li>Simulated Annealing</li>
</ul>
<p>Unlike SKATER and REDCAP that one can specify the number of clusters as an input paramter, max-p doesn’t allow to specify the number of clusters explicitly, but a constrained variable and the minimum bounding value that each cluster should reach that are used to find an optimized number of clusters.</p>
<p>For example, to use <code>greedy</code> algorithm in maxp function with the same dataset and weights as above to find optimal clusters using max-p:</p>
<p>First, we need to specify, for example, every cluster must have population &gt;= 3236.67 thousands people:</p>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb95-1" data-line-number="1">bound_vals &lt;-<span class="st"> </span>guerry<span class="op">$</span>table<span class="op">$</span>Pop1831</a>
<a class="sourceLine" id="cb95-2" data-line-number="2">min_bound &lt;-<span class="st"> </span><span class="fl">3236.67</span> <span class="co"># 10% of Pop1831</span></a></code></pre></div>
<p>Then, we can call the max-p function with “greedy” algorith, the bound values and minimum bound value:</p>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb96-1" data-line-number="1">maxp_clusters &lt;-<span class="st"> </span><span class="kw">maxp</span>(queen_w, data, bound_vals, min_bound, <span class="st">&quot;greedy&quot;</span>)</a>
<a class="sourceLine" id="cb96-2" data-line-number="2"></a>
<a class="sourceLine" id="cb96-3" data-line-number="3">betweenss &lt;-<span class="st"> </span><span class="kw">between_sumofsquare</span>(maxp_clusters, data)</a>
<a class="sourceLine" id="cb96-4" data-line-number="4">ratio &lt;-<span class="st"> </span>betweenss <span class="op">/</span><span class="st"> </span>totalss</a>
<a class="sourceLine" id="cb96-5" data-line-number="5"><span class="kw">cat</span>(<span class="st">&quot;The ratio of between to total sum of square:&quot;</span>, ratio)</a></code></pre></div>
<pre><code>## The ratio of between to total sum of square: 0.5070181</code></pre>
<p>We can also specify using <code>tabu search</code> algorithm in maxp function with the parameter of tabu length:</p>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb98-1" data-line-number="1">maxp_tabu_clusters &lt;-<span class="st"> </span><span class="kw">maxp</span>(queen_w, data, bound_vals, min_bound, <span class="st">&quot;tabu&quot;</span>, <span class="dt">tabu_length=</span><span class="dv">95</span>)</a>
<a class="sourceLine" id="cb98-2" data-line-number="2"></a>
<a class="sourceLine" id="cb98-3" data-line-number="3">betweenss &lt;-<span class="st"> </span><span class="kw">between_sumofsquare</span>(maxp_tabu_clusters, data)</a>
<a class="sourceLine" id="cb98-4" data-line-number="4">ratio &lt;-<span class="st"> </span>betweenss <span class="op">/</span><span class="st"> </span>totalss</a>
<a class="sourceLine" id="cb98-5" data-line-number="5"><span class="kw">cat</span>(<span class="st">&quot;The ratio of between to total sum of square:&quot;</span>, ratio)</a></code></pre></div>
<pre><code>## The ratio of between to total sum of square: 0.5280299</code></pre>
<p>To apply <code>simulated annealing</code> algorithm in maxp function with the parameter of cooling rate:</p>
<div class="sourceCode" id="cb100"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb100-1" data-line-number="1">maxp_sa_clusters &lt;-<span class="st"> </span><span class="kw">maxp</span>(queen_w, data, bound_vals, min_bound, <span class="st">&quot;sa&quot;</span>, <span class="dt">cool_rate=</span><span class="fl">0.75</span>)</a>
<a class="sourceLine" id="cb100-2" data-line-number="2"></a>
<a class="sourceLine" id="cb100-3" data-line-number="3">betweenss &lt;-<span class="st"> </span><span class="kw">between_sumofsquare</span>(maxp_sa_clusters, data)</a>
<a class="sourceLine" id="cb100-4" data-line-number="4">ratio &lt;-<span class="st"> </span>betweenss <span class="op">/</span><span class="st"> </span>totalss</a>
<a class="sourceLine" id="cb100-5" data-line-number="5"><span class="kw">cat</span>(<span class="st">&quot;The ratio of between to total sum of square:&quot;</span>, ratio)</a></code></pre></div>
<pre><code>## The ratio of between to total sum of square: 0.5260249</code></pre>
<p>We can also increase the number of iterations for local search process by specifying the parameter <code>initial</code> (default value is 99):</p>
<div class="sourceCode" id="cb102"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb102-1" data-line-number="1">maxp_clusters &lt;-<span class="st"> </span><span class="kw">maxp</span>(queen_w, data, bound_vals, min_bound, <span class="st">&quot;greedy&quot;</span>, <span class="dt">initial=</span><span class="dv">1000</span>)</a>
<a class="sourceLine" id="cb102-2" data-line-number="2"></a>
<a class="sourceLine" id="cb102-3" data-line-number="3">betweenss &lt;-<span class="st"> </span><span class="kw">between_sumofsquare</span>(maxp_clusters, data)</a>
<a class="sourceLine" id="cb102-4" data-line-number="4">ratio &lt;-<span class="st"> </span>betweenss <span class="op">/</span><span class="st"> </span>totalss</a>
<a class="sourceLine" id="cb102-5" data-line-number="5"><span class="kw">cat</span>(<span class="st">&quot;Tratio of between to total sum of square:&quot;</span>, ratio)</a></code></pre></div>
<pre><code>## Tratio of between to total sum of square: 0.5260249</code></pre>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="spatial-autocorrelation.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="esda-with-rgeoda-and-sp.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/rstudio/bookdown-demo/edit/master/05-spatialclustering.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"download": ["bookdown-demo.pdf", "bookdown-demo.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
