<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>5 Spatial Autocorrelation | rgeoda version 0.0.3</title>
  <meta name="description" content="This is a tutorial book to introduce the rgeoda v0.0.3 library. This book includes all the functions that are provided in version 0.0.3. Since rgeoda is under active development, this book will be updated frequently. Please watch this github repository to get any notifications." />
  <meta name="generator" content="bookdown 0.14 and GitBook 2.6.7" />

  <meta property="og:title" content="5 Spatial Autocorrelation | rgeoda version 0.0.3" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This is a tutorial book to introduce the rgeoda v0.0.3 library. This book includes all the functions that are provided in version 0.0.3. Since rgeoda is under active development, this book will be updated frequently. Please watch this github repository to get any notifications." />
  <meta name="github-repo" content="rgeoda/book_intro" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="5 Spatial Autocorrelation | rgeoda version 0.0.3" />
  
  <meta name="twitter:description" content="This is a tutorial book to introduce the rgeoda v0.0.3 library. This book includes all the functions that are provided in version 0.0.3. Since rgeoda is under active development, this book will be updated frequently. Please watch this github repository to get any notifications." />
  

<meta name="author" content="Xun Li" />


<meta name="date" content="2019-10-11" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="spatial-weights.html"/>
<link rel="next" href="spatial-clustering.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
<link rel="stylesheet" href="toc.css" type="text/css" />
<link rel="stylesheet" href="fontawesome.min.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">rgeoda v0.0.3</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a><ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#live-tutorials"><i class="fa fa-check"></i><b>1.1</b> Live Tutorials</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#open-resources"><i class="fa fa-check"></i><b>1.2</b> Open Resources</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>2</b> Installation</a><ul>
<li class="chapter" data-level="2.1" data-path="intro.html"><a href="intro.html#dependencies"><i class="fa fa-check"></i><b>2.1</b> Dependencies</a></li>
<li class="chapter" data-level="2.2" data-path="intro.html"><a href="intro.html#mac"><i class="fa fa-check"></i><b>2.2</b> Mac</a></li>
<li class="chapter" data-level="2.3" data-path="intro.html"><a href="intro.html#windows"><i class="fa fa-check"></i><b>2.3</b> Windows</a></li>
<li class="chapter" data-level="2.4" data-path="intro.html"><a href="intro.html#linux"><i class="fa fa-check"></i><b>2.4</b> Linux</a></li>
<li class="chapter" data-level="2.5" data-path="intro.html"><a href="intro.html#load-rgeoda-library-in-r"><i class="fa fa-check"></i><b>2.5</b> Load rgeoda library in R</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="load-spatial-data.html"><a href="load-spatial-data.html"><i class="fa fa-check"></i><b>3</b> Load Spatial Data</a><ul>
<li class="chapter" data-level="3.1" data-path="load-spatial-data.html"><a href="load-spatial-data.html#attributes-of-geoda-object"><i class="fa fa-check"></i><b>3.1</b> Attributes of <code>geoda</code> object</a></li>
<li class="chapter" data-level="3.2" data-path="load-spatial-data.html"><a href="load-spatial-data.html#access-table-data"><i class="fa fa-check"></i><b>3.2</b> Access Table Data</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="spatial-weights.html"><a href="spatial-weights.html"><i class="fa fa-check"></i><b>4</b> Spatial Weights</a><ul>
<li class="chapter" data-level="4.1" data-path="spatial-weights.html"><a href="spatial-weights.html#queen-contiguity-weights"><i class="fa fa-check"></i><b>4.1</b> Queen Contiguity Weights</a></li>
<li class="chapter" data-level="4.2" data-path="spatial-weights.html"><a href="spatial-weights.html#attributes-of-weight-object"><i class="fa fa-check"></i><b>4.2</b> Attributes of <code>Weight</code> object</a></li>
<li class="chapter" data-level="4.3" data-path="spatial-weights.html"><a href="spatial-weights.html#rook-contiguity-weights"><i class="fa fa-check"></i><b>4.3</b> Rook Contiguity Weights</a></li>
<li class="chapter" data-level="4.4" data-path="spatial-weights.html"><a href="spatial-weights.html#distance-based-weights"><i class="fa fa-check"></i><b>4.4</b> Distance Based Weights</a></li>
<li class="chapter" data-level="4.5" data-path="spatial-weights.html"><a href="spatial-weights.html#k-nearest-neighbor-weights"><i class="fa fa-check"></i><b>4.5</b> K-Nearest Neighbor Weights</a></li>
<li class="chapter" data-level="4.6" data-path="spatial-weights.html"><a href="spatial-weights.html#kernel-weights"><i class="fa fa-check"></i><b>4.6</b> Kernel Weights</a><ul>
<li class="chapter" data-level="4.6.1" data-path="spatial-weights.html"><a href="spatial-weights.html#kernel-weights-with-fixed-bandwidth"><i class="fa fa-check"></i><b>4.6.1</b> Kernel Weights with fixed bandwidth</a></li>
<li class="chapter" data-level="4.6.2" data-path="spatial-weights.html"><a href="spatial-weights.html#kernel-weights-with-adaptive-bandwidth"><i class="fa fa-check"></i><b>4.6.2</b> Kernel Weights with adaptive bandwidth</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="spatial-autocorrelation.html"><a href="spatial-autocorrelation.html"><i class="fa fa-check"></i><b>5</b> Spatial Autocorrelation</a><ul>
<li class="chapter" data-level="5.1" data-path="spatial-autocorrelation.html"><a href="spatial-autocorrelation.html#local-moran"><i class="fa fa-check"></i><b>5.1</b> Local Moran</a></li>
<li class="chapter" data-level="5.2" data-path="spatial-autocorrelation.html"><a href="spatial-autocorrelation.html#lisa-object"><i class="fa fa-check"></i><b>5.2</b> LISA object</a></li>
<li class="chapter" data-level="5.3" data-path="spatial-autocorrelation.html"><a href="spatial-autocorrelation.html#local-geary"><i class="fa fa-check"></i><b>5.3</b> Local Geary</a></li>
<li class="chapter" data-level="5.4" data-path="spatial-autocorrelation.html"><a href="spatial-autocorrelation.html#local-getis-ord-statistics"><i class="fa fa-check"></i><b>5.4</b> Local Getis-Ord Statistics</a></li>
<li class="chapter" data-level="5.5" data-path="spatial-autocorrelation.html"><a href="spatial-autocorrelation.html#local-join-count"><i class="fa fa-check"></i><b>5.5</b> Local Join Count</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="spatial-clustering.html"><a href="spatial-clustering.html"><i class="fa fa-check"></i><b>6</b> Spatial Clustering</a><ul>
<li class="chapter" data-level="6.1" data-path="spatial-clustering.html"><a href="spatial-clustering.html#skater"><i class="fa fa-check"></i><b>6.1</b> SKATER</a></li>
<li class="chapter" data-level="6.2" data-path="spatial-clustering.html"><a href="spatial-clustering.html#redcap"><i class="fa fa-check"></i><b>6.2</b> REDCAP</a></li>
<li class="chapter" data-level="6.3" data-path="spatial-clustering.html"><a href="spatial-clustering.html#max-p"><i class="fa fa-check"></i><b>6.3</b> Max-p</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="esda-with-rgeoda-and-sp.html"><a href="esda-with-rgeoda-and-sp.html"><i class="fa fa-check"></i><b>7</b> ESDA with rgeoda and sp</a><ul>
<li class="chapter" data-level="7.1" data-path="esda-with-rgeoda-and-sp.html"><a href="esda-with-rgeoda-and-sp.html#start-from-sp-package"><i class="fa fa-check"></i><b>7.1</b> Start from sp package</a></li>
<li class="chapter" data-level="7.2" data-path="esda-with-rgeoda-and-sp.html"><a href="esda-with-rgeoda-and-sp.html#create-geoda-object-from-sp"><i class="fa fa-check"></i><b>7.2</b> Create geoda object from sp</a></li>
<li class="chapter" data-level="7.3" data-path="esda-with-rgeoda-and-sp.html"><a href="esda-with-rgeoda-and-sp.html#esda-with-rgeoda-and-sp-1"><i class="fa fa-check"></i><b>7.3</b> ESDA with rgeoda and sp</a><ul>
<li class="chapter" data-level="7.3.1" data-path="esda-with-rgeoda-and-sp.html"><a href="esda-with-rgeoda-and-sp.html#local-moran-map"><i class="fa fa-check"></i><b>7.3.1</b> Local Moran Map</a></li>
<li class="chapter" data-level="7.3.2" data-path="esda-with-rgeoda-and-sp.html"><a href="esda-with-rgeoda-and-sp.html#local-geary-map"><i class="fa fa-check"></i><b>7.3.2</b> Local Geary Map</a></li>
<li class="chapter" data-level="7.3.3" data-path="esda-with-rgeoda-and-sp.html"><a href="esda-with-rgeoda-and-sp.html#local-g-map"><i class="fa fa-check"></i><b>7.3.3</b> Local G Map</a></li>
<li class="chapter" data-level="7.3.4" data-path="esda-with-rgeoda-and-sp.html"><a href="esda-with-rgeoda-and-sp.html#skater-map"><i class="fa fa-check"></i><b>7.3.4</b> SKATER Map</a></li>
<li class="chapter" data-level="7.3.5" data-path="esda-with-rgeoda-and-sp.html"><a href="esda-with-rgeoda-and-sp.html#max-p-clustering-map"><i class="fa fa-check"></i><b>7.3.5</b> Max-p Clustering Map</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="esda-with-rgeoda-and-sf.html"><a href="esda-with-rgeoda-and-sf.html"><i class="fa fa-check"></i><b>8</b> ESDA with rgeoda and sf</a><ul>
<li class="chapter" data-level="8.1" data-path="esda-with-rgeoda-and-sf.html"><a href="esda-with-rgeoda-and-sf.html#start-from-sf-package"><i class="fa fa-check"></i><b>8.1</b> Start from sf package</a></li>
<li class="chapter" data-level="8.2" data-path="esda-with-rgeoda-and-sf.html"><a href="esda-with-rgeoda-and-sf.html#create-geoda-object-from-sf"><i class="fa fa-check"></i><b>8.2</b> Create geoda object from sf</a></li>
<li class="chapter" data-level="8.3" data-path="esda-with-rgeoda-and-sf.html"><a href="esda-with-rgeoda-and-sf.html#esda-with-rgeoda-and-sf-1"><i class="fa fa-check"></i><b>8.3</b> ESDA with rgeoda and sf</a><ul>
<li class="chapter" data-level="8.3.1" data-path="esda-with-rgeoda-and-sf.html"><a href="esda-with-rgeoda-and-sf.html#local-moran-map-1"><i class="fa fa-check"></i><b>8.3.1</b> Local Moran Map</a></li>
<li class="chapter" data-level="8.3.2" data-path="esda-with-rgeoda-and-sf.html"><a href="esda-with-rgeoda-and-sf.html#local-geary-map-1"><i class="fa fa-check"></i><b>8.3.2</b> Local Geary Map</a></li>
<li class="chapter" data-level="8.3.3" data-path="esda-with-rgeoda-and-sf.html"><a href="esda-with-rgeoda-and-sf.html#local-g-map-1"><i class="fa fa-check"></i><b>8.3.3</b> Local G Map</a></li>
<li class="chapter" data-level="8.3.4" data-path="esda-with-rgeoda-and-sf.html"><a href="esda-with-rgeoda-and-sf.html#skater-map-1"><i class="fa fa-check"></i><b>8.3.4</b> SKATER Map</a></li>
<li class="chapter" data-level="8.3.5" data-path="esda-with-rgeoda-and-sf.html"><a href="esda-with-rgeoda-and-sf.html#max-p-clustering-map-1"><i class="fa fa-check"></i><b>8.3.5</b> Max-p Clustering Map</a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rgeoda/rgeoda-book" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">rgeoda version 0.0.3</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="spatial-autocorrelation" class="section level1">
<h1><span class="header-section-number">5</span> Spatial Autocorrelation</h1>
<p>rgeoda 0.0.3 provids following methods for univariate local spatial autocorrelation statistics:</p>
<ul>
<li>Local Moran: local_moran()</li>
<li>Local Geary: local_geary()</li>
<li>Local Getis-Ord statistics: local_g() and local_gstar()</li>
<li>Local Join Count: local_joincount()</li>
</ul>
<p>Methods for bivariate and multivariate local spatial autocorrelation statistics, as well as global spatial autocorrelation satatistics, will be included in next release of rgeoda.</p>
<p>In this tutorial, we will only introduce how to call these methods using pygeoda. For more information about the local spatial autocorrelation statisticis, please read the lab note that Dr. Luc Anselin wrote: <a href="http://geodacenter.github.io/workbook/6a_local_auto/lab6a.html" class="uri">http://geodacenter.github.io/workbook/6a_local_auto/lab6a.html</a>.</p>
<div id="local-moran" class="section level2">
<h2><span class="header-section-number">5.1</span> Local Moran</h2>
<p>The Local Moran statistic is a method to identify local clusters and local spatial outliers. For example, we can call function <code>local_moran()</code> with the created Queen weights and the data “crm_prp” as input parameters:</p>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb48-1" data-line-number="1">lisa &lt;-<span class="st"> </span><span class="kw">local_moran</span>(queen_w, crm_prp)</a></code></pre></div>
</div>
<div id="lisa-object" class="section level2">
<h2><span class="header-section-number">5.2</span> LISA object</h2>
<p>The <code>local_moran()</code> function will return a <code>lisa</code> object, which we can call its functions to access the results of lisa computation. The functions include:</p>
<pre><code>GetClusterIndicators()
----------------------
Get the local cluster indicators returned from LISA computation.

GetColors()
-----------
Get the cluster colors of LISA computation.

GetLabels()
-----------
Get the cluster labels of LISA computation.

GetLISAValues()
---------------
Get the local spatial autocorrelation values returned from LISA computation.

GetNumNeighbors()
-----------------
Get the number of neighbors of every observations in LISA computation.

GetPValues()
------------
Get the local pseudo-p values of significance returned from LISA computation.

SetPermutations(num_perm)
-------------------------
Set the number of permutations for the LISA computation

SetThreads(num_threads)
-----------------------
Set the number of CPU threads for the LISA computation

Run()
-----
Call to run LISA computation
</code></pre>
<p>For example, we can call the function <code>GetLISAValues()</code> to get the values of local Moran:</p>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb50-1" data-line-number="1">lms &lt;-<span class="st"> </span>lisa<span class="op">$</span><span class="kw">GetLISAValues</span>()</a>
<a class="sourceLine" id="cb50-2" data-line-number="2">lms</a></code></pre></div>
<pre><code>##  [1]  0.0154319783  0.3270633224  0.0212952962  0.0046105448 -0.0028342407
##  [6]  0.4149377158 -0.1379463091  0.0998657692  0.2823176310  0.1218745112
## [11] -0.0951205417  0.0326111938  0.3878324535  1.1888723840 -0.6452792226
## [16] -0.3096492740  0.3662775143  2.0375343539 -0.0050154800  0.0697110572
## [21]  2.2720355722  0.2886391551 -0.0070189726 -0.0009906605  0.9517469793
## [26]  0.7648322095  0.0432039929 -0.0045362842 -0.0964911860  0.0952360887
## [31]  0.0100895206 -0.0109401003 -0.0544245927 -0.0345553975  0.0887531916
## [36]  0.0954232056  0.0383617454 -0.1776714441  0.1638208393  1.2309154898
## [41]  2.9077203402 -0.0396340261  0.4458735227  0.2491123240  0.0905643622
## [46] -0.6212977834 -0.0308773407  0.0375870399  0.2270376112 -0.0918254739
## [51] -0.0112400086  0.1085584763 -0.0055113129 -0.0027097589  0.7235016208
## [56]  0.0163129939  0.4246564560  0.3787307767 -0.0597158189  0.5050011802
## [61]  2.7632125275  0.0656510809  0.1771899330 -0.0572150317  0.4943795537
## [66]  0.2870386197 -1.4593300774 -0.0055305930  0.4895990016 -0.0324125662
## [71]  2.1366499813  0.9041683235  0.7053678641  1.4098290925  0.0051652159
## [76]  0.2238144189 -0.1621373954  0.0195632289 -0.3233724187 -0.0337778226
## [81]  0.0118189869 -0.1164679533 -0.5699624657 -0.0859634996  0.2085373916</code></pre>
<p>To get the pseudo-p values of significance of local Moran computation:</p>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb52-1" data-line-number="1">pvals &lt;-<span class="st"> </span>lisa<span class="op">$</span><span class="kw">GetPValues</span>()</a>
<a class="sourceLine" id="cb52-2" data-line-number="2">pvals</a></code></pre></div>
<pre><code>##  [1] 0.414 0.123 0.001 0.474 0.452 0.087 0.243 0.326 0.299 0.303 0.237
## [12] 0.460 0.258 0.018 0.199 0.188 0.131 0.004 0.456 0.342 0.041 0.143
## [23] 0.429 0.412 0.002 0.026 0.480 0.400 0.121 0.350 0.481 0.441 0.338
## [34] 0.120 0.267 0.050 0.072 0.221 0.282 0.022 0.029 0.494 0.075 0.054
## [45] 0.200 0.025 0.359 0.346 0.280 0.375 0.487 0.267 0.441 0.428 0.135
## [56] 0.314 0.050 0.002 0.085 0.297 0.001 0.233 0.243 0.134 0.116 0.342
## [67] 0.015 0.334 0.069 0.303 0.040 0.132 0.001 0.002 0.470 0.007 0.213
## [78] 0.387 0.123 0.403 0.455 0.352 0.011 0.322 0.135</code></pre>
<p>To get the cluster indicators of local Moran computation:</p>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb54-1" data-line-number="1">cats &lt;-<span class="st"> </span>lisa<span class="op">$</span><span class="kw">GetClusterIndicators</span>()</a>
<a class="sourceLine" id="cb54-2" data-line-number="2">cats</a></code></pre></div>
<pre><code>##  [1] 0 0 1 0 0 0 0 0 0 0 0 0 0 1 0 0 0 1 0 0 1 0 0 0 2 2 0 0 0 0 0 0 0 0 0
## [36] 1 0 0 0 1 1 0 0 0 0 3 0 0 0 0 0 0 0 0 0 0 2 2 0 0 1 0 0 0 0 0 3 0 0 0
## [71] 2 0 2 2 0 2 0 0 0 0 0 0 3 0 0</code></pre>
<p>The predefined values of the indicators of LISA cluster are:</p>
<pre><code>0 Not significant
1 High-High
2 Low-Low
3 High-Low
4 Low-High
5 Neighborless
6 Undefined</code></pre>
<p>which can be accessed via function <code>GetLabels()</code>:</p>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb57-1" data-line-number="1">lbls &lt;-<span class="st"> </span>lisa<span class="op">$</span><span class="kw">GetLabels</span>()</a>
<a class="sourceLine" id="cb57-2" data-line-number="2">lbls</a></code></pre></div>
<pre><code>## [1] &quot;Not significant&quot; &quot;High-High&quot;       &quot;Low-Low&quot;         &quot;High-Low&quot;       
## [5] &quot;Low-High&quot;        &quot;Undefined&quot;       &quot;Isolated&quot;</code></pre>
<div class="rmdinfo">
<p>
Different LISA objects (e.g. local_geary()) will return different labels and colors.
</p>
</div>
<p>By default, the <code>local_moran()</code> function will run with some default parameters, e.g.:</p>
<pre><code>permutation number: 999
seed for random number generator: 123456789</code></pre>
<p>, which are identical to GeoDa desktop software so that we can replicate the results in GeoDa software. It is also easy to change the paremter and re-run the LISA computation by calling Run() function.</p>
<p>For example, re-run the above local Moran example using 9999 permutations</p>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb60-1" data-line-number="1">lisa<span class="op">$</span><span class="kw">SetPermutations</span>(<span class="dv">9999</span>)</a></code></pre></div>
<pre><code>## NULL</code></pre>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb62-1" data-line-number="1">lisa<span class="op">$</span><span class="kw">Run</span>()</a></code></pre></div>
<pre><code>## NULL</code></pre>
<p>Then, we can use the same <code>lisa</code> object to get the new results after 9999 permutations:</p>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb64-1" data-line-number="1">pvals &lt;-<span class="st"> </span>lisa<span class="op">$</span><span class="kw">GetPValues</span>()</a>
<a class="sourceLine" id="cb64-2" data-line-number="2">pvals</a></code></pre></div>
<pre><code>##  [1] 0.4187 0.1265 0.0004 0.4679 0.4545 0.0728 0.2312 0.3071 0.3115 0.3088
## [11] 0.2187 0.4803 0.2623 0.0113 0.2000 0.1797 0.1267 0.0026 0.4565 0.3517
## [21] 0.0450 0.1367 0.4344 0.4231 0.0024 0.0366 0.4741 0.4164 0.1293 0.3310
## [31] 0.4893 0.4371 0.3350 0.1376 0.2723 0.0567 0.0753 0.2221 0.2559 0.0192
## [41] 0.0216 0.4918 0.0739 0.0564 0.2193 0.0199 0.3667 0.3339 0.2764 0.3783
## [51] 0.4679 0.2683 0.4495 0.4312 0.1423 0.3158 0.0612 0.0009 0.0900 0.2861
## [61] 0.0001 0.2378 0.2518 0.1295 0.1262 0.3482 0.0105 0.3152 0.0692 0.2984
## [71] 0.0260 0.1331 0.0001 0.0001 0.4683 0.0067 0.2197 0.3718 0.1392 0.4054
## [81] 0.4420 0.3462 0.0039 0.3136 0.1288</code></pre>
<p>rgeoda uses GeoDa’s C++ code, in which multi-threading is used to accelerate the computation of LISA. We can specify how many threads to run the computation:</p>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb66-1" data-line-number="1">lisa<span class="op">$</span><span class="kw">SetThreads</span>(<span class="dv">4</span>)</a></code></pre></div>
<pre><code>## NULL</code></pre>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb68-1" data-line-number="1">lisa<span class="op">$</span><span class="kw">Run</span>()</a></code></pre></div>
<pre><code>## NULL</code></pre>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb70-1" data-line-number="1">lisa<span class="op">$</span><span class="kw">GetPValues</span>()</a></code></pre></div>
<pre><code>##  [1] 0.4187 0.1265 0.0004 0.4679 0.4545 0.0728 0.2312 0.3071 0.3115 0.3088
## [11] 0.2187 0.4834 0.2686 0.0102 0.2024 0.1795 0.1218 0.0025 0.4590 0.3588
## [21] 0.0476 0.1456 0.4344 0.4231 0.0024 0.0366 0.4741 0.4164 0.1293 0.3310
## [31] 0.4893 0.4371 0.3350 0.1424 0.2751 0.0564 0.0713 0.2202 0.2672 0.0186
## [41] 0.0214 0.4960 0.0721 0.0589 0.2288 0.0189 0.3759 0.3217 0.2812 0.3735
## [51] 0.4695 0.2743 0.4518 0.4286 0.1471 0.3222 0.0647 0.0016 0.0955 0.2840
## [61] 0.0001 0.2388 0.2465 0.1242 0.1275 0.3493 0.0120 0.3158 0.0719 0.2979
## [71] 0.0291 0.1386 0.0001 0.0003 0.4627 0.0058 0.2168 0.3761 0.1386 0.4119
## [81] 0.4631 0.3421 0.0045 0.3138 0.1257</code></pre>
</div>
<div id="local-geary" class="section level2">
<h2><span class="header-section-number">5.3</span> Local Geary</h2>
<p>Local Geary is a type of LISA that focuses on squared differences/dissimilarity. A small value of the local geary statistics suggest positive spatial autocorrelation, whereas large values suggest negative spatial autocorrelation.</p>
<p>For example, we can call the function <code>local_geary()</code> with the created Queen weights and the data “crm_prp” as input parameters:</p>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb72-1" data-line-number="1">geary_crmprs &lt;-<span class="st"> </span><span class="kw">local_geary</span>(queen_w, crm_prp)</a></code></pre></div>
<p>To get the cluster indicators of the local Geary computation:</p>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb73-1" data-line-number="1">geary_crmprs<span class="op">$</span><span class="kw">GetClusterIndicators</span>()</a></code></pre></div>
<pre><code>##  [1] 0 2 4 0 3 0 0 0 0 0 0 0 0 0 0 0 0 1 0 2 1 0 0 0 2 2 0 0 0 0 0 0 0 4 0
## [36] 0 0 0 0 0 1 0 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
## [71] 2 0 0 2 0 0 0 0 0 0 0 0 4 0 0</code></pre>
<p>To get the pseudo-p values of the local Geary computation:</p>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb75-1" data-line-number="1">geary_crmprs<span class="op">$</span><span class="kw">GetPValues</span>()</a></code></pre></div>
<pre><code>##  [1] 0.398 0.027 0.025 0.126 0.017 0.314 0.610 0.141 0.284 0.110 0.559
## [12] 0.462 0.211 0.236 0.249 0.229 0.069 0.041 0.205 0.020 0.029 0.178
## [23] 0.369 0.112 0.024 0.027 0.092 0.420 0.488 0.051 0.377 0.253 0.217
## [34] 0.049 0.110 0.151 0.147 0.584 0.327 0.107 0.009 0.129 0.135 0.190
## [45] 0.031 0.086 0.084 0.292 0.299 0.418 0.053 0.431 0.178 0.077 0.092
## [56] 0.294 0.116 0.321 0.573 0.204 0.196 0.264 0.084 0.616 0.131 0.408
## [67] 0.058 0.088 0.282 0.264 0.040 0.085 0.059 0.002 0.711 0.543 0.620
## [78] 0.057 0.335 0.411 0.197 0.625 0.010 0.364 0.265</code></pre>
</div>
<div id="local-getis-ord-statistics" class="section level2">
<h2><span class="header-section-number">5.4</span> Local Getis-Ord Statistics</h2>
<p>There are two types of local Getis-Ord statistics: one is computing a ratio of the weighted average of the values in the neighboring locations, not including the value at the location; while another type of statistic includes the value at the location in both numerator and denominator.</p>
<p>A value larger than the mean suggests a high-high cluster or hot spot, a value smaller than the mean indicates a low-low cluster or cold spot.</p>
<p>For example, we can call the function <code>local_g()</code> with the created Queen weights and the data “crm_prp” as input parameters:</p>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb77-1" data-line-number="1">localg_crmprs &lt;-<span class="st"> </span><span class="kw">local_g</span>(queen_w, crm_prp)</a></code></pre></div>
<p>To get the cluster indicators of the local G computation:</p>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb78-1" data-line-number="1">localg_crmprs<span class="op">$</span><span class="kw">GetClusterIndicators</span>()</a></code></pre></div>
<pre><code>##  [1] 0 0 1 0 0 0 0 0 0 0 0 0 0 1 0 0 0 1 0 0 1 0 0 0 2 2 0 0 0 0 0 0 0 0 0
## [36] 1 0 0 0 1 1 0 0 0 0 1 0 0 0 0 0 0 0 0 0 0 2 2 0 0 1 0 0 0 0 0 1 0 0 0
## [71] 2 0 2 2 0 2 0 0 0 0 0 0 1 0 0</code></pre>
<p>To get the pseudo-p values of the local G computation:</p>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb80-1" data-line-number="1">localg_crmprs<span class="op">$</span><span class="kw">GetPValues</span>()</a></code></pre></div>
<pre><code>##  [1] 0.414 0.123 0.001 0.474 0.452 0.087 0.243 0.326 0.299 0.303 0.237
## [12] 0.460 0.258 0.018 0.199 0.188 0.131 0.004 0.456 0.342 0.041 0.143
## [23] 0.429 0.412 0.002 0.026 0.479 0.400 0.121 0.350 0.481 0.441 0.338
## [34] 0.120 0.266 0.050 0.072 0.221 0.282 0.022 0.029 0.494 0.075 0.054
## [45] 0.200 0.025 0.359 0.346 0.280 0.375 0.487 0.266 0.441 0.428 0.135
## [56] 0.314 0.050 0.002 0.085 0.297 0.001 0.233 0.243 0.134 0.116 0.340
## [67] 0.015 0.334 0.069 0.303 0.039 0.132 0.001 0.002 0.470 0.007 0.213
## [78] 0.387 0.123 0.403 0.455 0.352 0.011 0.322 0.135</code></pre>
<p>For the second type of local Getis-Ord statistics, we can call the function <code>local_gstar()</code> with the created Queen weights and the data “crm_prp” as input parameters:</p>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb82-1" data-line-number="1">localgstar_crmprs &lt;-<span class="st"> </span><span class="kw">local_gstar</span>(queen_w, crm_prp)</a></code></pre></div>
</div>
<div id="local-join-count" class="section level2">
<h2><span class="header-section-number">5.5</span> Local Join Count</h2>
<p>Local Join Count is a method to identify local clusters for binary data by using a local version of the so-called BB join count statistic. The statistic is only meaningful for those observations with value 1.</p>
<p>For example, we can load the columbus dataset, and call the function <code>local_joincount()</code> with a Queen weights and the data “nsa”, which is a set of binary (0,1) values, as input parameters:</p>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb83-1" data-line-number="1">columbus_path &lt;-<span class="st"> </span><span class="kw">system.file</span>(<span class="st">&quot;extdata&quot;</span>, <span class="st">&quot;columbus.shp&quot;</span>, <span class="dt">package =</span> <span class="st">&quot;rgeoda&quot;</span>)</a>
<a class="sourceLine" id="cb83-2" data-line-number="2">columbus &lt;-<span class="st"> </span><span class="kw">geoda_open</span>(columbus_path)</a>
<a class="sourceLine" id="cb83-3" data-line-number="3"></a>
<a class="sourceLine" id="cb83-4" data-line-number="4">columbus_w &lt;-<span class="st"> </span><span class="kw">queen_weights</span>(columbus)</a>
<a class="sourceLine" id="cb83-5" data-line-number="5">localjc_crmprs &lt;-<span class="st"> </span><span class="kw">local_joincount</span>(columbus_w, columbus<span class="op">$</span>table<span class="op">$</span>nsa)</a></code></pre></div>
<p>To get the cluster indicators of the local Join Count computation:</p>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb84-1" data-line-number="1">localjc_crmprs<span class="op">$</span><span class="kw">GetClusterIndicators</span>()</a></code></pre></div>
<pre><code>##  [1] 0 0 1 1 1 0 1 1 1 0 1 1 1 1 1 1 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
## [36] 0 0 0 0 0 0 0 0 0 0 0 0 0 0</code></pre>
<p>To get the pseudo-p values of the local Join Count computation:</p>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb86-1" data-line-number="1">localjc_crmprs<span class="op">$</span><span class="kw">GetPValues</span>()</a></code></pre></div>
<pre><code>##  [1] 0.213 0.070 0.017 0.010 0.001 0.234 0.018 0.007 0.006 0.275 0.017
## [12] 0.008 0.043 0.004 0.002 0.001 0.147 0.049 0.087 0.001 0.001 0.372
## [23] 0.001 0.450 0.287 0.249 0.001 0.001 0.001 0.001 0.001 0.001 0.001
## [34] 0.001 0.001 0.001 0.001 0.001 0.001 0.001 0.001 0.001 0.001 0.001
## [45] 0.001 0.001 0.001 0.001 0.001</code></pre>
<p>To get the number of neighbors of the local Join Count computation:</p>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb88-1" data-line-number="1">localjc_crmprs<span class="op">$</span><span class="kw">GetNumNeighbors</span>()</a></code></pre></div>
<pre><code>##  [1]  2  3  4  5  8  2  5  6  8  4  5  6  4  6  6  8  3  4  3 10  3  6  3
## [24]  7  8  6  4  9  7  5  3  4  4  4  7  5  6  6  3  5  3  2  6  5  4  2
## [47]  2  4  3</code></pre>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="spatial-weights.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="spatial-clustering.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/rgeoda/rgeoda-book/edit/master/04-spatialautocorrelation.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"download": ["rgeoda-book.pdf", "rgeoda-book.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
